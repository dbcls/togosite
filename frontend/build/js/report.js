!function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=e.get(t);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(t):n.value}function a(t,e,n){var r=e.get(t);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(t,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}function u(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var c=new WeakMap,s=new WeakMap,l=new(function(){function e(){t(this,e),c.set(this,{writable:!0,value:void 0}),s.set(this,{writable:!0,value:void 0})}return n(e,[{key:"setSubjects",value:function(t){for(var e=this,n=0;n<t.length;n++){var r=360-360*n/t.length+180;r-=r>360?360:0,t[n].hue=r}a(this,c,Object.freeze(t)),a(this,s,[]),t.forEach((function(t){t.properties.forEach((function(n){i(e,s).push(Object.assign({subjectId:t.subjectId},n))}))})),console.log(i(this,c)),console.log(i(this,s))}},{key:"setValues",value:function(t,e){i(this,s).find((function(e){return e.propertyId===t})).values=e}},{key:"getProperty",value:function(t){console.log(t);var e=i(this,s).find((function(e){return e.propertyId===t}));return console.log(e),e}},{key:"getValue",value:function(t,e){return this.getProperty(t).values.find((function(t){return t.categoryId===e}))}},{key:"subjects",get:function(){return i(this,c)}},{key:"properties",get:function(){return i(this,s)}}]),e}()),f=new WeakMap,p=new WeakSet,d=new WeakSet,h=function(){function e(){t(this,e),d.add(this),p.add(this),f.set(this,{writable:!0,value:void 0})}return n(e,[{key:"ready",value:function(){var t,e=this;Promise.all([fetch("https://raw.githubusercontent.com/dbcls/togosite/develop/config/togosite-human/properties.json"),fetch("https://raw.githubusercontent.com/dbcls/togosite/develop/config/togosite-human/templates.json")]).then((function(t){return Promise.all(t.map((function(t){return t.json()})))})).then((function(e){var n=r(e,2),o=n[0],i=n[1];return t=i,l.setSubjects(o),document.querySelector("head").insertAdjacentHTML("beforeend",i.stanzas.map((function(t){return'<script type="module" src="'.concat(t,'"><\/script>')})).join("")),Promise.all(Object.keys(i.templates).map((function(t){return fetch(i.templates[t])})))})).then((function(t){return Promise.all(t.map((function(t){return t.text()})))})).then((function(n){a(e,f,Object.fromEntries(Object.keys(t.templates).map((function(t,e){return[t,n[e]]})))),u(e,p,y).call(e)}))}},{key:"getHslColor",value:function(t){return"hsl(".concat(t,", 50%, 55%)")}}]),e}(),y=function(){var t=this,e=Object.fromEntries(window.location.search.substr(1).split("&").map((function(t){return t.split("=")}))),n=JSON.parse(decodeURIComponent(e.properties)),r=document.querySelector("main"),o=l.subjects.find((function(t){return t.togoKey===e.togoKey})).subjectId;r.innerHTML=u(this,d,v).call(this,o,e.id,e.togoKey)+n.map((function(e){if(void 0===e)return"";var n=l.subjects.find((function(t){return t.properties.some((function(t){return t.propertyId===e.propertyId}))})),r=n.properties.find((function(t){return t.propertyId==t.propertyId}));return'<hr>\n          <div class="attributes">\n            <header style="background-color: '.concat(t.getHslColor(n.hue),';">').concat(r.label,"</header>\n            ").concat(e.attributes.map((function(r){return u(t,d,v).call(t,n.subjectId,r.id,e.propertyKey)})).join(""),"\n          </div>")})).join("")},v=function(t,e,n){return'<div class="stanza">'.concat(i(this,f)[t].replace(/{{id}}/g,e).replace(/{{type}}/g,n),"</div>")},b=new h;globalThis.togositeapp=b,b.ready()}();