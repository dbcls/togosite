{"version":3,"file":"main.js","sources":["../../source/js/classes/DefaultEventEmitter.js","../../source/js/classes/Records.js","../../source/js/events.js","../../source/js/classes/ConditionBuilder.js","../../source/js/classes/ConditionBuilderView.js","../../source/js/classes/ReportsView.js","../../source/js/functions/collapseView.js","../../source/js/classes/ColumnSelectorView.js","../../source/js/classes/HistogramRangeSelectorView.js","../../source/js/classes/TrackOverviewCategorical.js","../../source/js/classes/TrackView.js","../../source/js/classes/ConceptView.js","../../source/js/classes/StatisticsView.js","../../source/js/classes/ResultsTable.js","../../source/js/classes/BalloonView.js","../../source/js/classes/TableData.js","../../source/js/classes/ConditionsController.js","../../source/js/classes/UploadUserIDsView.js","../../source/js/api.js","../../source/js/classes/App.js","../../source/js/main.js"],"sourcesContent":["class DefaultEventEmitter extends EventTarget {\n\n  constructor() {\n    super();\n  }\n\n}\n\nexport default new DefaultEventEmitter();\n","\nclass Records {\n\n  #subjects;\n  #properties;\n\n  constructor() {\n  }\n\n  // public methods\n\n  setSubjects(subjects) {\n    // define subjects\n    for (let i = 0; i < subjects.length; i++) {\n      let hue = 360 - (360 * i / subjects.length) + 130;\n      hue -= hue > 360 ? 360 : 0;\n      subjects[i].hue = hue;\n    }\n    this.#subjects = Object.freeze(subjects);\n    // set properties\n    this.#properties = [];\n    subjects.forEach(subject => {\n      subject.properties.forEach(property => {\n        this.#properties.push(Object.assign({subjectId: subject.subjectId}, property));\n      });\n    });\n    console.log(this.#subjects);\n    console.log(this.#properties);\n  }\n\n  setValues(propertyId, values) {\n    const property = this.#properties.find(property => property.propertyId === propertyId);\n    property.values = values;\n  }\n\n  getProperty(propertyId) {\n    const property = this.#properties.find(property => property.propertyId === propertyId);\n    return property;\n  }\n\n  getValue(propertyId, categoryId) {\n    // const property = this.#properties.find(property => property.propertyId === propertyId);\n    const property = this.getProperty(propertyId);\n    const value = property.values.find(value => value.categoryId === categoryId);\n    return value;\n  }\n\n  // public accessors\n\n  get subjects() {\n    return this.#subjects;\n  }\n\n  get properties() {\n    return this.#properties;\n  }\n\n}\n\nexport default new Records();\n","// TogoKey\nexport const defineTogoKey = 'defineTogoKey';\n\n// User IDs\nexport const setUserValues = 'setUserValues';\nexport const clearUserValues = 'clearUserValues';\n\n// View mode\nexport const changeViewModes = 'changeViewModes';\n\n// Condition\nexport const mutatePropertyCondition = 'mutatePropertyCondition';\nexport const mutatePropertyValueCondition = 'mutatePropertyValueCondition';\nexport const mutateEstablishConditions = 'mutateEstablishConditions';\nexport const completeQueryParameter = 'completeQueryParameter';\n\n// Stanza\nexport const hideStanza = 'hideStanza';\nexport const showStanza = 'showStanza';\n\n// Polling\nexport const failedFetchTableDataIds = 'failedFetchTableDataIds';\nexport const addNextRows = 'addNextRows';\n\n// Table\nexport const selectTableData = 'selectTableData';\n\n// Track\nexport const enterPropertyValueItemView = 'enterPropertyValueItemView';\nexport const leavePropertyValueItemView = 'leavePropertyValueItemView';\n","import DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport Records from \"./Records\";\nimport * as event from '../events';\n\nclass ConditionBuilder {\n\n  #propertyConditions;\n  #attributeConditions;\n  #subjectId;\n  #togoKey;\n\n  constructor() {\n    this.#propertyConditions = [];\n    this.#attributeConditions = [];\n  }\n\n  // public methods\n\n  addProperty(condition) {\n    console.log('addProperty', condition)\n    // store\n    this.#propertyConditions.push(condition);\n    // evaluate\n    this.#satisfyAggregation();\n    // dispatch event\n    const customEvent = new CustomEvent(event.mutatePropertyCondition, {detail: {\n      action: 'add', \n      condition\n    }});\n    DefaultEventEmitter.dispatchEvent(customEvent);\n  }\n\n  addPropertyValue(condition) {\n    console.log('add condition', condition)\n    // store\n    this.#attributeConditions.push(condition);\n    // evaluate\n    this.#satisfyAggregation();\n    // dispatch event\n    const customEvent = new CustomEvent(event.mutatePropertyValueCondition, {detail: {\n      action: 'add', \n      condition\n    }});\n    DefaultEventEmitter.dispatchEvent(customEvent);\n  }\n\n  removeProperty(propertyId) {\n    // remove from store\n    const index = this.#propertyConditions.findIndex(condition => condition.property.propertyId === propertyId);\n    if (index === -1) return;\n    this.#propertyConditions.splice(index, 1)[0];\n    // evaluate\n    this.#satisfyAggregation();\n    // dispatch event\n    const customEvent = new CustomEvent(event.mutatePropertyCondition, {detail: {action: 'remove', propertyId}});\n    DefaultEventEmitter.dispatchEvent(customEvent);\n  }\n\n  removePropertyValue(propertyId, categoryId) {\n    // remove from store\n    const index = this.#attributeConditions.findIndex(condition => condition.property.propertyId === propertyId && condition.value.categoryId === categoryId);\n    if (index === -1) return;\n    this.#attributeConditions.splice(index, 1)[0];\n    // evaluate\n    this.#satisfyAggregation();\n    // dispatch event\n    const customEvent = new CustomEvent(event.mutatePropertyValueCondition, {detail: {action: 'remove', propertyId, categoryId}});\n    DefaultEventEmitter.dispatchEvent(customEvent);\n  }\n\n  setPropertyValues(condition) {\n    const originalValues = Records.getProperty(condition.property.propertyId).values;\n    const startIndex = originalValues.findIndex(originalValue => originalValue.categoryId === condition.values[0].categoryId);\n    originalValues.forEach((originalValue, originalIndex) => {\n      const index = this.#attributeConditions.findIndex(attrCondition => attrCondition.property.propertyId === condition.property.propertyId && attrCondition.value.categoryId === originalValue.categoryId);\n      if (startIndex <= originalIndex && originalIndex < startIndex + condition.values.length) {\n        const value = condition.values[originalIndex - startIndex];\n        // add\n        if (index === -1) {\n          this.addPropertyValue({\n            subject: condition.subject,\n            property: condition.property,\n            value \n          });\n        }\n      } else {\n        // remove\n        if (index !== -1) {\n          this.removePropertyValue(condition.property.propertyId, originalValue.categoryId);\n        }\n      }\n    });\n  }\n\n  makeQueryParameter() {\n    // create properties\n    const properties = this.#propertyConditions.map(condition => {\n      return {\n        query: {\n          propertyId: condition.property.propertyId\n        },\n        property: condition.property,\n        subject: condition.subject\n      };\n    });\n    const attributesForEachProperties = {};\n    this.#attributeConditions.forEach(condition => {\n      const propertyId = condition.property.propertyId;\n      if (!attributesForEachProperties[propertyId]) attributesForEachProperties[propertyId] = [];\n      attributesForEachProperties[propertyId].push(condition.value.categoryId);\n    });\n    // create attributes (property values)\n    const attributes = Object.keys(attributesForEachProperties).map(propertyId => {\n      return {\n        query: {\n          propertyId,\n          categoryIds: attributesForEachProperties[propertyId]\n        },\n        property: this.#attributeConditions.find(condition => condition.property.propertyId === propertyId).property,\n        subject: this.#attributeConditions.find(condition => condition.property.propertyId === propertyId).subject\n      };\n    });\n    // emmit event\n    const customEvent = new CustomEvent(event.completeQueryParameter, {detail: {\n      togoKey: this.#togoKey,\n      subjectId: this.#subjectId,\n      properties,\n      attributes\n    }});\n    DefaultEventEmitter.dispatchEvent(customEvent);\n  }\n\n  setSubject(togoKey, subjectId) {\n    this.#togoKey = togoKey;\n    this.#subjectId = subjectId;\n    this.#satisfyAggregation();\n  }\n\n  // public accessor\n\n  get currentTogoKey() {\n    return this.#togoKey;\n  }\n\n  // private methods\n\n  #satisfyAggregation() {\n    const established \n      = (this.#togoKey && this.#subjectId)\n      && (this.#propertyConditions.length > 0 || this.#attributeConditions.length > 0);\n    const customEvent = new CustomEvent(event.mutateEstablishConditions, {detail: established});\n    DefaultEventEmitter.dispatchEvent(customEvent);\n  }\n\n}\n\nexport default new ConditionBuilder();\n","import App from \"./App\";\nimport ConditionBuilder from \"./ConditionBuilder\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport * as event from '../events';\n\nexport default class ConditionBuilderView {\n\n  #TOGO_KEYS;\n  #PROPERTIES_CONDITIONS_CONTAINER;\n  #ATTRIBUTES_CONDITIONS_CONTAINER;\n  #EXEC_BUTTON;\n\n  constructor(elm) {\n\n    // references\n    const body = document.querySelector('body');\n    const conditionsContainer = elm.querySelector(':scope > .conditions');\n    this.#TOGO_KEYS = conditionsContainer.querySelector(':scope > .togoKey > select');\n    this.#PROPERTIES_CONDITIONS_CONTAINER = conditionsContainer.querySelector(':scope > .properties > .conditions');\n    this.#ATTRIBUTES_CONDITIONS_CONTAINER = conditionsContainer.querySelector(':scope > .attributes > .conditions');\n    this.#EXEC_BUTTON = elm.querySelector(':scope > footer > button.exec');\n\n    // attach event\n    this.#EXEC_BUTTON.addEventListener('click', () => {\n      body.dataset.display = 'results';\n      ConditionBuilder.makeQueryParameter();\n    });\n\n    // event listeners\n    DefaultEventEmitter.addEventListener(event.mutatePropertyCondition, e => {\n      switch (e.detail.action) {\n        case 'add':\n          this.#addProperty(e.detail.condition.subject, e.detail.condition.property);\n          break;\n        case 'remove':\n          this.#removeProperty(e.detail.propertyId);\n          break;\n      }\n    });\n    DefaultEventEmitter.addEventListener(event.mutatePropertyValueCondition, e => {\n      switch (e.detail.action) {\n        case 'add':\n          this.#addPropertyValue(e.detail.condition.subject, e.detail.condition.property, e.detail.condition.value);\n          break;\n        case 'remove':\n          this.#removePropertyValue(e.detail.propertyId, e.detail.categoryId);\n          break;\n      }\n    });\n    DefaultEventEmitter.addEventListener(event.defineTogoKey, e => {\n      this.#defineTogoKeys(e.detail);\n    });\n    DefaultEventEmitter.addEventListener(event.mutateEstablishConditions, e => {\n      this.#EXEC_BUTTON.disabled = !e.detail;\n    });\n\n  }\n\n  // private methods\n\n  #defineTogoKeys(togoKeys) {\n    // make options\n    this.#TOGO_KEYS.innerHTML = togoKeys.map(togoKey => `<option value=\"${togoKey.togoKey}\" data-subject-id=\"${togoKeys.subjectId}\">${togoKey.label} (${togoKey.togoKey})</option>`).join('');\n    this.#TOGO_KEYS.disabled = false;\n    // attach event\n    this.#TOGO_KEYS.addEventListener('change', e => {\n      const togoKey = togoKeys.find(togoKey => togoKey.togoKey === e.target.value);\n      ConditionBuilder.setSubject(e.target.value, togoKey.subjectId);\n    });\n    this.#TOGO_KEYS.dispatchEvent(new Event('change'));\n  }\n\n  #addProperty(subject, property) {\n    // make view\n    const view = document.createElement('div');\n    view.classList.add('stacking-condition-view');\n    view.dataset.propertyId = property.propertyId;\n    view.innerHTML = `\n    <div class=\"closebutton\"></div>\n    <ul class=\"path\">\n      <li>${subject.subject}</li>\n    </ul>\n    <div class=\"label\" style=\"color: ${App.getHslColor(subject.hue)};\">${property.label}</div>`;\n    this.#PROPERTIES_CONDITIONS_CONTAINER.insertAdjacentElement('beforeend', view);\n    this.#PROPERTIES_CONDITIONS_CONTAINER.classList.remove('-empty');\n    // event\n    view.querySelector(':scope > .closebutton').addEventListener('click', () => {\n      ConditionBuilder.removeProperty(view.dataset.propertyId);\n    });\n  }\n  \n  #removeProperty(propertyId) {\n    const view = this.#PROPERTIES_CONDITIONS_CONTAINER.querySelector(`[data-property-id=\"${propertyId}\"]`);\n    view.parentNode.removeChild(view);\n    if (this.#PROPERTIES_CONDITIONS_CONTAINER.childNodes.length === 0) this.#PROPERTIES_CONDITIONS_CONTAINER.classList.add('-empty');\n  }\n\n  #addPropertyValue(subject, property, value) {\n    // make view\n    const view = document.createElement('div');\n    view.classList.add('stacking-condition-view');\n    view.classList.add('-value');\n    view.dataset.propertyId = property.propertyId;\n    view.dataset.categoryId = value.categoryId;\n    // view.dataset.range = [0, 0]; // TODO:\n    view.style.backgroundColor = `hsl(${subject.hue}, 45%, 50%)`;\n    view.innerHTML = `\n    <div class=\"closebutton\"></div>\n    <ul class=\"path\">\n      <li>${subject.subject}</li>\n      <li>${property.label}</li>\n      ${value.ancestors.map(ancestor => `<li>${ancestor}</li>`).join('')}\n    </ul>\n    <div class=\"label\">${value.label}</div>`;\n    this.#ATTRIBUTES_CONDITIONS_CONTAINER.insertAdjacentElement('beforeend', view);\n    this.#ATTRIBUTES_CONDITIONS_CONTAINER.classList.remove('-empty');\n    // event\n    view.querySelector(':scope > .closebutton').addEventListener('click', () => {\n      ConditionBuilder.removePropertyValue(view.dataset.propertyId, view.dataset.categoryId);\n    });\n  }\n\n  #removePropertyValue(propertyId, categoryId) {\n    const view = this.#ATTRIBUTES_CONDITIONS_CONTAINER.querySelector(`[data-property-id=\"${propertyId}\"][data-category-id=\"${categoryId}\"]`);\n    view.parentNode.removeChild(view);\n    if (this.#ATTRIBUTES_CONDITIONS_CONTAINER.childNodes.length === 0) this.#ATTRIBUTES_CONDITIONS_CONTAINER.classList.add('-empty');\n  }\n\n}","import DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport Records from './Records.js';\nimport * as event from '../events';\n\nexport default class ReportsView {\n\n  #templates;\n  #BODY;\n  #STANZAS_CONTAINER;\n\n  constructor(elm) {\n\n    this._stanzas = {};\n\n    // references\n    this.#BODY = document.querySelector('body');\n    this.#STANZAS_CONTAINER = elm.querySelector(':scope > .stanzas');\n    const returnButton = elm.querySelector(':scope > footer > button.return');\n\n    // attach event\n    returnButton.addEventListener('click', () => {\n      this.#BODY.dataset.display = 'properties';\n    });\n\n    // event listener\n    DefaultEventEmitter.addEventListener(event.showStanza, e => {\n      this.#showStanza(e.detail.subject, e.detail.properties);\n    });\n    DefaultEventEmitter.addEventListener(event.hideStanza, e => {\n      this.#hideStanza();\n    });\n  }\n\n  // private methods\n\n  #showStanza(subject, properties) {\n    console.log(subject, properties)\n    // make stanzas\n    this.#STANZAS_CONTAINER.innerHTML\n      = this.#stanza(subject.id, subject.value)\n      +　properties\n        .map(property => {\n          if (property === undefined) {\n            return '';\n          } else {\n            const subject = Records.subjects.find(subject => subject.properties.some(subjectProperty => subjectProperty.propertyId === property.propertyId));\n            // TODO: 1個目のアトリビュートしか返していない\n            return this.#stanza(subject.subjectId, property.attributes[0].id);\n          }\n        }).join('');\n  }\n\n  #hideStanza() {\n    this.#STANZAS_CONTAINER.innerHTML = '';\n  }\n\n  #stanza(subjectId, value) {\n    return `<div class=\"stanza-view\">${this.#templates[subjectId].replace(/{{id}}/g, value)}</div>`;\n  }\n\n  // public methods\n\n  defineTemplates(templates) {\n    console.log(templates)\n    this.#templates = templates;\n  }\n\n}\n","export default function collapseView(elm) {\n  const button = elm.querySelector(`.collapsebutton[data-collapse=\"${elm.dataset.collapse}\"]`);\n  const content = elm.querySelector(`.collapsingcontent[data-collapse=\"${elm.dataset.collapse}\"]`);\n  button.addEventListener('click', () => {\n    elm.classList.toggle('-spread');\n    button.classList.toggle('-spread');\n    content.classList.toggle('-spread');\n  });\n}\n","import App from \"./App\";\nimport ConditionBuilder from \"./ConditionBuilder\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport * as event from '../events';\n\nexport default class ColumnSelectorView {\n\n  constructor(elm, subject, property, items, sparqlist) {\n\n    this._subject = subject;\n    this._property = property;\n    this._sparqlist = sparqlist;\n    this._itemStatus = {};\n    this._columns = [];\n\n    // make container\n    elm.innerHTML = `\n    <div class=\"column-selector-view\">\n      <div class=\"columns\">\n        <div class=\"inner\"></div>\n      </div>\n      <div class=\"loading-view\"></div>\n    </div>`;\n    this._view = elm.querySelector(':scope > .column-selector-view');\n    this._container = this._view.querySelector(':scope > .columns > .inner');\n    this._loadingView = this._view.querySelector(':scope > .loading-view');\n\n    // even listener\n    DefaultEventEmitter.addEventListener(event.mutatePropertyValueCondition, e => {\n      let propertyId, categoryId;\n      switch (e.detail.action) {\n        case 'add':\n          propertyId = e.detail.condition.property.propertyId;\n          categoryId = e.detail.condition.value.categoryId;\n          break;\n        case 'remove':\n          propertyId = e.detail.propertyId;\n          categoryId = e.detail.categoryId;\n          break;\n      }\n      if (this._property.propertyId == propertyId) { // TODO: Number型になればこの処理は厳密比較に\n        this._columns.forEach(ul => {\n          ul.querySelectorAll('li').forEach(li => {\n            if (li.dataset.id == categoryId) { // TODO: Number型になればこの処理は厳密比較に\n              const isChecked = e.detail.action === 'add';\n              li.querySelector(':scope > input[type=\"checkbox\"]').checked = isChecked;\n              this._itemStatus[li.dataset.id].checked = isChecked;\n            }\n          })\n        });\n      }\n    });\n\n    this._addItems(items, 0);\n    this._makeColumn(items, 0);\n  }\n\n  _addItems(items, depth, parent) {\n    // console.log(items, depth)\n    for (const item of items) {\n      const hasChild = item.hasChild && item.hasChild === true;\n      this._itemStatus[item.categoryId] = {\n        label: item.label,\n        parent,\n        hasChild: hasChild ? true : false,\n        depth,\n        selected: false,\n        checked: false\n      }\n      if (hasChild) {\n        this._itemStatus[item.categoryId].children = [];\n      }\n    }\n    // console.log(this._itemStatus)\n  }\n\n  _makeColumn(items, depth) {\n    // console.log(items)\n\n    this._items = items.map(item => Object.assign({}, item));\n\n    // get column element\n    let ul;\n    if (this._columns[depth]) {\n      ul = this._columns[depth];\n    } else {\n      ul = document.createElement('ul');\n      ul.classList.add('column');\n      this._columns[depth] = ul;\n    }\n\n    // make items\n    ul.innerHTML = this._items.map(item => {\n      return `<li class=\"item${item.hasChild ? ' -haschild' : ''}\" data-id=\"${item.categoryId}\">\n        <input type=\"checkbox\" value=\"${item.categoryId}\"/>\n        <span class=\"label\">${item.label}</span>\n        <span class=\"count\">${item.count.toLocaleString()}</span>\n      </li>`;\n    }).join('');\n    this._container.insertAdjacentElement('beforeend', ul);\n    ul.querySelectorAll(':scope > .item').forEach((item, index) => {\n      this._items[index].elm = item;\n    })\n    this._update(App.viewModes.log10);\n\n    // drill down event\n    ul.querySelectorAll(':scope > .item.-haschild').forEach(item => {\n      item.addEventListener('click', () => {\n        item.classList.add('-selected');\n        // delete an existing lower columns\n        if (this._columns.length > depth + 1) {\n          for (let i = depth + 1; i < this._columns.length; i++) {\n            if (this._columns[i].parentNode) this._container.removeChild(this._columns[i]);\n          }\n        }\n        // deselect siblings\n        const selectedItemKeys = Object.keys(this._itemStatus).filter(id => this._itemStatus[id].selected && this._itemStatus[id].depth >= depth);\n        for (const key of selectedItemKeys) {\n          this._itemStatus[key].selected = false;\n          const selectedItem = this._columns[depth].querySelector(`[data-id=\"${key}\"]`);\n          if (selectedItem) selectedItem.classList.remove('-selected');\n        }\n        // get lower column\n        this._itemStatus[item.dataset.id].selected = true;\n        this._getChildren(item.dataset.id, depth + 1);\n      });\n    });\n\n    // select/deselect a item (attribute)\n    ul.querySelectorAll(':scope > .item > input[type=\"checkbox\"]').forEach(checkbox => {\n      checkbox.addEventListener('click', e => {\n        e.stopPropagation();\n        if (checkbox.checked) { // add\n          const ancestors = [];\n          let id = checkbox.value;\n          let parent;\n          do {\n            parent = this._itemStatus[id].parent;\n            if (parent) ancestors.unshift(this._itemStatus[parent]);\n            id = parent;\n          } while (parent);\n          ConditionBuilder.addPropertyValue({\n            subject: this._subject,\n            property: this._property,\n            value: {\n              categoryId: checkbox.value,\n              label: this._itemStatus[checkbox.value].label,\n              ancestors: ancestors.map(ancestor => ancestor.label)\n            }\n          });\n        } else { // remove\n          ConditionBuilder.removePropertyValue(this._property.propertyId, checkbox.value);\n        }\n      });\n    });\n\n    // event listener\n    DefaultEventEmitter.addEventListener(event.changeViewModes, e => this._update(e.detail.log10));\n  }\n\n  _update(isLog10) {\n    let max = Math.max(...Array.from(this._items).map(item => item.count));\n    max = isLog10 ? Math.log10(max) : max;\n    this._items.forEach(item => {\n      item.elm.style.backgroundColor = `hsl(${this._subject.hue}, 75%, ${100 - (isLog10 ? Math.log10(item.count) : item.count) / max * 40}%)`;\n    });\n  }\n\n  _getChildren(id, depth) {\n    // loading\n    this._loadingView.classList.add('-shown');\n    fetch(this._sparqlist + '?categoryIds=' + id)\n      .then(responce => responce.json())\n      .then(json => {\n        this._addItems(json, depth, id);\n        this._makeColumn(json, depth);\n        this._loadingView.classList.remove('-shown');\n        // scroll\n        const gap = this._view.scrollWidth - this._view.clientWidth;\n        if (gap > 0) this._view.scrollLeft = gap;\n      });\n  }\n\n}","import App from \"./App\";\nimport ConditionBuilder from \"./ConditionBuilder\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport * as event from '../events';\n\nconst PADDING = 10;\nconst NUM_OF_GRID = 4;\n\nexport default class HistogramRangeSelectorView {\n\n  #items;\n  #subject;\n  #property;\n  #selectedBarsStart;\n  #selectedBarsEnd;\n  #OVERVIEW_CONTAINER;\n  #ROOT;\n  #SELECTOR_BARS;\n  #GRIDS;\n\n  constructor(elm, subject, property, items, sparqlist, overview) {\n    console.log(elm, subject, property, items, sparqlist)\n\n    this.#subject = subject;\n    this._sparqlist = sparqlist;\n    this.#property = property;\n    this.#OVERVIEW_CONTAINER = overview;\n    this.#items = items.map(item => Object.assign({}, item));\n    this.#selectedBarsStart = undefined;\n    this.#selectedBarsEnd = undefined;\n\n    // make container\n    elm.innerHTML = `\n    <div class=\"histogram-range-selector-view\">\n      <div class=\"selector\">\n        <div class=\"overview\"></div>\n        <div class=\"controller\"></div>\n      </div>\n      <div class=\"histogram\">\n        <div class=\"graph\"></div>\n        <div class=\"gridcontainer\">\n          ${'<div class=\"grid\"><p class=\"label\"></p></div>'.repeat(NUM_OF_GRID)}\n        </div>\n        <svg class=\"additionalline\"></svg>\n      </div>\n      <!--\n      <div class=\"controller\">\n        <div class=\"selector\">\n          <div class=\"slider -min\"></div>\n          <div class=\"slider -max\"></div>\n        </div>\n        <div class=\"form\">\n          <input type=\"number\" data-range=\"min\">\n          ~\n          <input type=\"number\" data-range=\"max\">\n        </div>\n      </div>\n      -->`;\n    this.#ROOT = elm.querySelector(':scope > .histogram-range-selector-view');\n    const histogram = this.#ROOT.querySelector(':scope > .histogram');\n    const selector = this.#ROOT.querySelector(':scope > .selector');\n\n    // make graph\n    const max = Math.max(...this.#items.map(item => item.count));\n    const width = 100 / this.#items.length;\n    selector.querySelector(':scope > .overview').innerHTML = this.#items.map(item => `<div class=\"bar\" data-category-id=\"${item.categoryId}\" data-count=\"${item.count}\" style=\"width: ${width}%; height: ${(item.count / max) * 100}%; background-color: ${App.getHslColor(subject.hue)};\"></div>`).join('');\n    const graph = histogram.querySelector(':scope > .graph');\n    graph.innerHTML = this.#items.map((item, index) => `<div class=\"bar\" data-category-id=\"${item.categoryId}\" data-count=\"${item.count}\">\n      <div class=\"actual\" style=\"background-color: ${App.getHslColor(subject.hue)};\">\n        <div class=\"color\" style=\"background-color: hsla(${360 * index / this.#items.length}, 70%, 50%, .075);\"></div>\n      </div>\n      <p class=\"label\">${item.label}</p>\n    </div>`).join('');\n\n    // reference\n    histogram.querySelectorAll(':scope > .graph > .bar').forEach((item, index) => this.#items[index].elm = item);\n    this.#GRIDS = histogram.querySelectorAll(':scope > .gridcontainer > .grid');\n    this.#SELECTOR_BARS = Array.from(selector.querySelectorAll(':scope > .overview > .bar'));\n\n    // event\n    DefaultEventEmitter.addEventListener(event.changeViewModes, e => this.#update());\n    \n    this.#setupRangeSelector();\n    this.#update();\n  }\n\n\n  // private methods\n\n  #setupRangeSelector() {\n    const selectorController = this.#ROOT.querySelector(':scope > .selector > .controller')\n\n    let isMouseDown = false, startX, width, unit;\n    selectorController.addEventListener('mousedown', e => {\n      width = e.target.getBoundingClientRect().width;\n      unit = width / this.#items.length;\n      isMouseDown = true;\n      startX = e.layerX;\n    });\n    selectorController.addEventListener('mousemove', e => {\n      if (isMouseDown) {\n        // selection range\n        const selectedWidth = e.layerX - startX;\n        if (selectedWidth > 0) {\n          this.#selectedBarsStart = Math.floor(startX / unit);\n          this.#selectedBarsEnd = Math.floor(e.layerX / unit)\n        } else {\n          this.#selectedBarsStart = Math.floor(e.layerX / unit);\n          this.#selectedBarsEnd = Math.floor(startX / unit)\n        }\n        // select overview by range\n        this.#ROOT.querySelectorAll(':scope > .selector > .overview > .bar').forEach((bar, index) => {\n          if (this.#selectedBarsStart <= index && index <= this.#selectedBarsEnd) {\n            bar.classList.add('-selected');\n          } else {\n            bar.classList.remove('-selected');\n          }\n        });\n        this.#update();\n        // set condition\n        const selectedItems = this.#selectedItems;\n        ConditionBuilder.setPropertyValues({\n          subject: this.#subject,\n          property: this.#property,\n          values: selectedItems.map(item => {\n            return {\n              categoryId: item.categoryId,\n              label: item.label,\n              ancestors: []\n            }\n          })\n        });\n      }\n    });\n    selectorController.addEventListener('mouseup', e => {\n      if (isMouseDown) {\n        isMouseDown = false;\n      }\n    });\n  }\n\n  #update() {\n\n    const selectedItems = this.#selectedBarsStart ? this.#selectedItems : this.#items;\n\n    const max = Math.max(...selectedItems.map(item => item.count));\n    const isLog10 = App.viewModes.log10;\n    const processedMax = isLog10 ? Math.log10(max) : max;\n    const width = 100 / selectedItems.length;\n\n    // grid\n    const digits = String(Math.ceil(max)).length;\n    const unit = Number(String(max).charAt(0).padEnd(digits, '0')) / NUM_OF_GRID;\n    this.#GRIDS.forEach((grid, index) => {\n      const scale = unit * index;\n      grid.style.bottom = `${(isLog10 ? Math.log10(scale) : scale) / processedMax * 100}%`;\n      grid.querySelector(':scope > .label').textContent = (scale).toLocaleString();\n    });\n\n    // graph\n    this.#items.forEach(item => {\n      if (selectedItems.indexOf(item) === -1) {\n        item.elm.classList.add('-filtered');\n      } else {\n        item.elm.classList.remove('-filtered');\n        const height = (isLog10 ? Math.log10(item.count) : item.count) / processedMax * 100;\n        item.elm.style.width = `${width}%`;\n        item.elm.querySelector(':scope > .actual').style.height = `${height}%`;\n        }\n    });\n  }\n\n  #indicateValue() {\n\n  }\n\n  // private accessor\n  get #selectedItems() {\n    let items;\n    if (this.#selectedBarsStart) {\n      items = this.#items.filter((item_, index) => {\n        if (this.#selectedBarsStart <= index && index <= this.#selectedBarsEnd) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n    } else {\n      items = [];\n    }\n    return items;\n  }\n\n}","import App from \"./App\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport ConditionBuilder from \"./ConditionBuilder\";\nimport * as event from '../events';\n\nconst MIN_PIN_SIZE = 12;\nconst MAX_PIN_SIZE = 20;\nconst RANGE_PIN_SIZE = MAX_PIN_SIZE - MIN_PIN_SIZE;\n\nexport default class TrackOverviewCategorical {\n\n  #subject;\n  #property;\n  #values;\n  #ROOT;\n\n  constructor(elm, subject, property, values) {\n\n    this.#ROOT = elm;\n    this.#subject = subject;\n    this.#property = property;\n    this.#values = values.map(value => Object.assign({}, value));\n\n    // make overview\n    // TODO: ヒストグラムは別処理\n    const sum = values.reduce((acc, value) => acc + value.count, 0);\n    const width = 100 / values.length;\n    elm.innerHTML = this.#values.map((value, index) => {\n      value.countLog10 = value.count === 0 ? 0 : Math.log10(value.count);\n      value.width = value.count / sum * 100;\n      value.color = `hsla(${360 * index / values.length}, 70%, 50%, .075)`;\n      return `\n        <li class=\"track-value-view\" style=\"width: ${width}%;\" data-category-id=\"${value.categoryId}\">\n          <div class=\"color\" style=\"background-color: ${value.color};\"></div>\n          <div class=\"heatmap\"></div>\n          <p>\n            <span class=\"label\">${value.label}</span>\n            <span class=\"count\">${value.count.toLocaleString()}</span>\n          </p>\n          <div class=\"pin\"></div>\n        </li>`;\n    }).join('');\n\n    elm.querySelectorAll(':scope > .track-value-view').forEach((elm, index) => {\n\n      // reference\n      const value = this.#values[index];\n      value.elm = elm;\n      const pin = elm.querySelector(':scope > .pin');\n      value.pin = pin;\n\n      // attach event: show tooltip\n      const label = `<span style=\"color: ${App.getHslColor(this.#subject.hue)}\">${value.label}</span>`;\n      elm.addEventListener('mouseenter', () => {\n        const customEvent = new CustomEvent(event.enterPropertyValueItemView, {detail: {\n          label,\n          values: [\n            {\n              key: 'Count',\n              value: value.count.toLocaleString()\n            }\n          ],\n          elm\n        }});\n        DefaultEventEmitter.dispatchEvent(customEvent);\n      });\n      elm.addEventListener('mouseleave', () => {\n        const customEvent = new CustomEvent(event.leavePropertyValueItemView);\n        DefaultEventEmitter.dispatchEvent(customEvent);\n      });\n\n      // attach event: show tooltip of pin\n      pin.addEventListener('mouseenter', () => {\n        const customEvent = new CustomEvent(event.enterPropertyValueItemView, {detail: {\n          label,\n          values: [\n            {\n              key: 'Count',\n              value: `${value.userValueCount.toLocaleString()} / ${value.count.toLocaleString()}`\n            }\n          ],\n          elm: pin\n        }});\n        DefaultEventEmitter.dispatchEvent(customEvent);\n      });\n      pin.addEventListener('mouseleave', () => {\n        const customEvent = new CustomEvent(event.leavePropertyValueItemView);\n        DefaultEventEmitter.dispatchEvent(customEvent);\n      });\n\n      // attach event: select/deselect a value\n      elm.addEventListener('click', () => {\n        if (elm.classList.contains('-selected')) {\n          elm.classList.remove('-selected');\n          ConditionBuilder.removePropertyValue(this.#property.propertyId, value.categoryId);\n        } else {\n          elm.classList.add('-selected');\n          ConditionBuilder.addPropertyValue({\n            subject: this.#subject,\n            property: this.#property,\n            value: {\n              categoryId: value.categoryId,\n              label: value.label,\n              count: value.count,\n              ancestors: []\n            }\n          });\n        }\n      });\n    });\n\n    // event listener\n    DefaultEventEmitter.addEventListener(event.mutatePropertyValueCondition, e => {\n      let propertyId, categoryId;\n      switch (e.detail.action) {\n        case 'add':\n          propertyId = e.detail.condition.property.propertyId;\n          categoryId = e.detail.condition.value.categoryId;\n          break;\n        case 'remove':\n          propertyId = e.detail.propertyId;\n          categoryId = e.detail.categoryId;\n          break;\n      }\n      if (this.#property.propertyId === propertyId) {\n        this.#values.forEach(value => {\n          if (value.categoryId === categoryId) {\n            switch (e.detail.action) {\n              case 'add':\n                value.elm.classList.add('-selected');\n                break;\n              case 'remove':\n                value.elm.classList.remove('-selected');\n                break;\n            }\n          }\n        });\n      }\n    });\n    DefaultEventEmitter.addEventListener(event.changeViewModes, e => this.#update(e.detail));\n    DefaultEventEmitter.addEventListener(event.setUserValues, e => this.#plotUserIdValues(e.detail));\n    DefaultEventEmitter.addEventListener(event.clearUserValues, e => this.#clearUserIdValues(e.detail));\n\n    this.#update(App.viewModes);\n  }\n\n  #update(viewModes) {\n    const isArea = viewModes.area;\n    const isLog10 = viewModes.log10;\n    const sum = this.#values.reduce((acc, value) => acc + (isLog10 ? value.countLog10 : value.count), 0);\n    let max = Math.max(...this.#values.map(value => value.count));\n    max = isLog10 ? Math.log10(max) : max;\n    const fixedWidth = isArea ? 0 : 100 / this.#values.length;\n    let width;\n    let left = 0;\n    this.#values.forEach(value => {\n      width = isArea ? (isLog10 ? Math.log10(value.count) : value.count) / sum * 100 : fixedWidth;\n      value.elm.style.width = width + '%';\n      value.elm.style.left = left + '%';\n      value.elm.querySelector(':scope > .heatmap').style.backgroundColor = `rgba(51, 50, 48, ${1 - (isLog10 ? value.countLog10 : value.count) / max})`;\n      left += width;\n    });\n  }\n\n  #plotUserIdValues(detail) {\n    if (this.#property.propertyId === detail.propertyId) {\n      this.#ROOT.classList.add('-pinsticking');\n\n      console.log(detail, this.#values)\n\n      this.#values.forEach(value => {\n        const userValue = detail.values.find(userValue => userValue.categoryId === value.categoryId);\n        if (userValue) {\n          value.elm.classList.add('-pinsticking');\n          // pin\n          const ratio = userValue.count / value.count;\n          const size = MIN_PIN_SIZE + RANGE_PIN_SIZE * ratio;\n          value.pin.style.width = size + 'px';\n          value.pin.style.height = size + 'px';\n          value.pin.style.top = -size + 'px';\n          value.pin.style.left = (-size / 2) + 'px';\n          value.userValueCount =  userValue.count;\n        } else {\n          value.elm.classList.remove('-pinsticking');\n        }\n      });\n    }\n  }\n\n  #clearUserIdValues() {\n    this.#values.forEach(value => value.elm.classList.remove('-pinsticking'));\n  }\n\n}\n","import App from \"./App\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport Records from \"./Records\";\nimport ConditionBuilder from \"./ConditionBuilder\";\nimport collapseView from '../functions/collapseView.js';\nimport ColumnSelectorView from './ColumnSelectorView.js';\nimport HistogramRangeSelectorView from './HistogramRangeSelectorView.js';\nimport TrackOverviewCategorical from './TrackOverviewCategorical.js';\nimport * as event from '../events';\n\nexport default class TrackView {\n\n  #subject;\n  #property;\n  #sparqlist;\n  #ROOT;\n  #LOADING_VIEW;\n  #SELECT_CONTAINER;\n  #OVERVIEW_CONTAINER;\n  #CHECKBOX_ALL_PROPERTIES;\n\n  constructor(subject, property, container, positionRate) {\n    // console.log(subject, property, container)\n\n    const elm = document.createElement('div');\n    container.insertAdjacentElement('beforeend', elm);\n    this.#ROOT = elm;\n    this.#subject = subject;\n    this.#property = property;\n    this.#sparqlist = property.data;\n    elm.classList.add('track-view');\n    elm.classList.add('-preparing');\n    elm.classList.add('collapse-view');\n    elm.dataset.propertyId = property.propertyId;\n    elm.dataset.collapse = property.propertyId;\n\n    // make html\n    elm.innerHTML = `\n    <div class=\"row -upper\">\n      <div class=\"left definition\">\n        <div class=\"collapsebutton\" data-collapse=\"${property.propertyId}\">\n          <h2 class=\"title\">${property.label}</h2>\n        </div>\n      </div>\n      <div class=\"right values\">\n        <div class=\"overview\" style=\"background-color: ${App.getHslColor(subject.hue)};\">\n          <ul class=\"inner\"></ul>\n          <div class=\"loading-view -shown\"></div>\n        </div>\n      </div>\n    </div>\n    <div class=\"row -lower collapsingcontent\" data-collapse=\"${property.propertyId}\">\n      <div class=\"left\">\n        <p class=\"description\">${property.description}</p>\n        <label><input type=\"checkbox\">All properties</label>\n      </div>\n      <div class=\"right selector\"></div>\n    </div>`;\n    const valuesContainer = elm.querySelector(':scope > .row.-upper > .values');\n    this.#OVERVIEW_CONTAINER = valuesContainer.querySelector(':scope > .overview > .inner');\n    this.#LOADING_VIEW = valuesContainer.querySelector(':scope > .overview > .loading-view');\n    this.#SELECT_CONTAINER = elm.querySelector(':scope > .row.-lower > .selector');\n\n    // collapse\n    collapseView(elm);\n\n    // select/deselect a property\n    this.#CHECKBOX_ALL_PROPERTIES = elm.querySelector(':scope > .row.-lower > .left > label > input');\n    this.#CHECKBOX_ALL_PROPERTIES.addEventListener('change', e => {\n      e.stopPropagation();\n      if (this.#CHECKBOX_ALL_PROPERTIES.checked) { // add\n        ConditionBuilder.addProperty({\n          subject: this.#subject,\n          property: this.#property\n        });\n        this.#ROOT.classList.add('-allselected');\n      } else { // remove\n        ConditionBuilder.removeProperty(this.#property.propertyId);\n        this.#ROOT.classList.remove('-allselected');\n      }\n    });\n    // event listener\n    DefaultEventEmitter.addEventListener(event.mutatePropertyCondition, e => {\n      if (e.detail.action === 'remove') {\n        if (e.detail.propertyId === this.#property.propertyId) {\n          this.#CHECKBOX_ALL_PROPERTIES.checked = false;\n          this.#ROOT.classList.remove('-allselected');\n        }\n      }\n    });\n\n    // get property data\n    fetch(property.data)\n      .then(responce => responce.json())\n      .then(json => this.#makeValues(json))\n      .catch(error => {\n        console.error(error)\n        this.#OVERVIEW_CONTAINER.insertAdjacentHTML('afterend',`<div class=\"error\">${error} - <a href=\"${property.data}\" target=\"_blank\">${property.data}</a></div>`);\n        this.#LOADING_VIEW.classList.remove('-shown');\n      });\n  }\n\n  // private methods\n\n  #makeValues(values) {\n\n    this.#ROOT.classList.remove('-preparing');\n    this.#LOADING_VIEW.classList.remove('-shown');\n    Records.setValues(this.#property.propertyId, values);\n\n    // make overview\n    new TrackOverviewCategorical(this.#OVERVIEW_CONTAINER, this.#subject, this.#property, values);\n\n    // make selector view\n    if (this.#property.viewMethod && this.#property.viewMethod === 'histogram') {\n      new HistogramRangeSelectorView(\n        this.#SELECT_CONTAINER,\n        this.#subject,\n        this.#property,\n        values,\n        this.#sparqlist,\n        this.#OVERVIEW_CONTAINER\n      );\n    } else {\n      new ColumnSelectorView(\n        this.#SELECT_CONTAINER,\n        this.#subject,\n        this.#property,\n        values,\n        this.#sparqlist\n      );\n    }\n  }\n\n}\n","import App from \"./App\";\nimport TrackView from './TrackView.js';\n\nexport default class ConceptView {\n\n  constructor(subject, elm) {\n    elm.classList.add('concept-view');\n    elm.innerHTML = `\n    <h3 class=\"title\" style=\"background-color: ${App.getHslColor(subject.hue)};\">\n      <span>${subject.subject}</span>\n    </h3>\n    <div class=\"properties\"></div>`;\n\n    // make tracks\n    const properties = subject.properties;\n    const propertiesContainer = elm.querySelector(':scope > .properties');\n    for (let i = 0; i < properties.length; i++) {\n      const property = properties[i];\n      new TrackView(subject, property, propertiesContainer, i / properties.length);\n    }\n  }\n\n}\n","import App from \"./App\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport Records from './Records.js';\nimport * as event from '../events';\n\nexport default class StatisticsView {\n\n  #propertyId;\n  #hue;\n  #COUNTS;\n  #RATES;\n  #TICKS;\n\n  constructor(elm, property) {\n    console.log(property)\n\n    this.#propertyId = property.property.propertyId;\n    this.#hue = App.getHslColor(property.subject.hue);\n\n    elm.classList.add('statistics-view');\n\n    // make HTML\n    elm.innerHTML = `<div class=\"statistics\">\n      <div class=\"counts\"></div>\n      <div class=\"rates\"></div>\n      <div class=\"ticks\"></div>\n    </div>`;\n\n    // references\n    const container = elm.querySelector(':scope > .statistics');\n    this.#COUNTS = container.querySelector(':scope > .counts');\n    this.#RATES = container.querySelector(':scope > .rates');\n    this.#TICKS = container.querySelector(':scope > .ticks');\n\n    // event listener\n    DefaultEventEmitter.addEventListener(event.addNextRows, e => this.#draw(e.detail));\n  }\n\n  /**\n   * @param {TableData} detail.tableData\n   * @param {Array} detail.rows\n   * @param {Boolean} detail.done\n   */\n  #draw(detail) {\n\n    // const data = detail.tableData.data;\n    const attributes = detail.tableData.data\n      .map(datum => datum.properties.find(property => property.propertyId === this.#propertyId))\n      .filter(property => property !== undefined)\n      .map(property => property.attributes)\n      .flat()\n      .map(property => property.attribute);\n\n    const categoryIds = [...new Set(attributes.map(attribute => attribute.categoryId))];\n    \n    // count\n    const counts = categoryIds.map(categoryId => attributes.filter(attribute => attribute.categoryId === categoryId).length);\n    const countMax = Math.max(...counts);\n    // draw\n    this.#COUNTS.innerHTML = counts.map(count => {\n      const position = (count / countMax < .5) ? ' -below' : '';\n      return `\n      <div class=\"bar\" style=\"height: ${count / countMax * 100}%; background-color: ${this.#hue};\">\n        <div class=\"value${position}\">${count.toLocaleString()}</div>\n      </div>`;\n    }).join('');\n\n    // rate\n    const rates = categoryIds.map((categoryId, index) => {\n      const value = Records.getValue(this.#propertyId, categoryId);\n      const sum = value.count * detail.tableData.rateOfProgress;\n      return counts[index] / sum;\n    });\n    const rateMax = Math.max(...rates);\n    // draw\n    this.#RATES.innerHTML = rates.map(rate => {\n      const position = (rate / rateMax < .5) ? ' -below' : '';\n      return `\n      <div class=\"bar\" style=\"height: ${rate / rateMax * 100}%; background-color: ${this.#hue};\">\n        <div class=\"value${position}\">${rate.toLocaleString()}</div>\n      </div>`;\n    }).join('');\n\n    // tick\n    const labels = categoryIds.map(categoryId => attributes.find(attribute => attribute.categoryId === categoryId)).map(attribute => attribute.label);\n    this.#TICKS.innerHTML = labels.map(label => {\n      return `\n      <div class=\"bar\">\n        <div class=\"label\">${label}</div>\n      </div>`;\n    }).join('');\n  }\n\n}","import App from \"./App\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport StatisticsView from \"./StatisticsView\";\nimport Records from './Records.js';\nimport * as event from '../events';\n\nexport default class ResultsTable {\n\n  #intersctionObserver;\n  #tableData;\n  #header;\n  #ROOT;\n  #THEAD;\n  #STATS;\n  #TBODY;\n  #TABLE_END;\n  #LOADING_VIEW;\n\n  constructor(elm) {\n\n    // references\n    this.#ROOT = elm;\n    const TABLE = elm.querySelector(':scope > .body > table');\n    this.#THEAD = TABLE.querySelector(':scope > thead > tr.header');\n    this.#STATS = TABLE.querySelector(':scope > thead > tr.statistics');\n    this.#TBODY = TABLE.querySelector(':scope > tbody');\n    this.#TABLE_END = elm.querySelector(':scope > .body > .tableend');\n    this.#LOADING_VIEW = this.#TABLE_END.querySelector(':scope > .loading-view');\n\n    // get next data automatically\n    this.#intersctionObserver = new IntersectionObserver(entries => {\n      for (const entry of entries) {\n        if (entry.target === this.#TABLE_END) {\n          if (entry.isIntersecting) {\n            this.#enterTableEnd();\n          }\n        }\n      }\n    });\n\n    // event listener\n    DefaultEventEmitter.addEventListener(event.selectTableData, e => this.#setupTable(e.detail));\n    DefaultEventEmitter.addEventListener(event.addNextRows, e => this.#addTableRows(e.detail));\n    DefaultEventEmitter.addEventListener(event.failedFetchTableDataIds, e => this.#failed(e.detail));\n\n    // turnoff intersection observer after display transition\n    const mutationObserver = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        if (mutation.type === 'attributes' && mutation.attributeName === 'data-display') {\n          if (mutation.target.dataset.display !== 'results') {\n            this.#intersctionObserver.unobserve(this.#TABLE_END);\n            // deselect table data\n            this.#tableData.deselect();\n          }\n        }\n      });\n    });\n    mutationObserver.observe(\n      document.querySelector('body'),\n      {attributes: true}\n    );\n  }\n\n  // private methods\n\n  #enterTableEnd() {\n    this.#intersctionObserver.unobserve(this.#TABLE_END);\n    this.#tableData.next();\n  }\n\n  #setupTable(tableData) {\n\n    const properties = tableData.condition.attributes.concat(tableData.condition.properties);\n\n    // reset\n    this.#tableData = tableData;\n    this.#intersctionObserver.unobserve(this.#TABLE_END);\n    this.#header = properties.map(property => {\n      return {\n        subjectId: property.subject.subjectId,\n        propertyId: property.property.propertyId\n      };\n    });\n    this.#ROOT.classList.remove('-complete');\n    this.#THEAD.innerHTML = '';\n    this.#TBODY.innerHTML = '';\n    this.#LOADING_VIEW.classList.add('-shown');\n    DefaultEventEmitter.dispatchEvent(new CustomEvent(event.hideStanza));\n\n    // make table header\n    this.#THEAD.innerHTML = `\n      <th>\n        <div class=\"inner\">\n          <div class=\"togo-key-view\">${tableData.condition.togoKey}</div>\n        </div>\n      </th>\n      ${tableData.condition.attributes.map(property => `\n      <th>\n        <div class=\"inner -propertyvalue\" style=\"background-color: ${App.getHslColor(property.subject.hue)}\">\n          <div class=\"togo-key-view\">${property.property.primaryKey}</div>\n          <span>${property.property.label}</span>\n        </div>\n      </th>`).join('')}\n      ${tableData.condition.properties.map(property => `\n      <th>\n        <div class=\"inner -property\" style=\"color: ${App.getHslColor(property.subject.hue)}\">\n          <div class=\"togo-key-view\">${property.property.primaryKey}</div>\n          <span>${property.property.label}</span>\n        </div>\n      </th>`).join('')}`;\n\n      // make stats\n      this.#STATS.innerHTML = '<td><div class=\"inner\"><div></td>' + properties.map(() => `<td><div class=\"inner\"><div></div></div></td>`).join('');\n      this.#STATS.querySelectorAll(':scope > td > .inner > div').forEach((elm, index) => {\n        if (index === 0 ) return;\n        new StatisticsView(elm, properties[index - 1]);\n      });\n  }\n\n  #addTableRows(detail) {\n    console.log(detail)\n\n    this.#tableData = detail.tableData;\n\n    // normalize\n    const rows = [];\n    detail.rows.forEach(row => {\n      rows.push([...detail.tableData.serializedHeader.map(head => row.properties.find(property => property.propertyId === head))]);\n    });\n\n    // make table\n    this.#TBODY.insertAdjacentHTML('beforeend', rows.map((row, index) => {\n      console.log(row)\n      return `<tr data-index=\"${detail.tableData.offset + index}\" data-togo-id=\"${detail.rows[index].id}\">\n        <th>\n          <div class=\"inner\">\n            <a class=\"toreportpage\" href=\"report.html?togoKey=${detail.tableData.togoKey}&id=${detail.rows[index].id}&properties=${encodeURIComponent(JSON.stringify(row))}\" target=\"_blank\"><span class=\"material-icons-outlined\">open_in_new</span></a>\n            <div\n              class=\"togo-key-view\"\n              data-subject-id=\"${detail.tableData.subjectId}\"\n              data-key=\"${detail.tableData.togoKey}\"\n              data-category-id=\"${detail.rows[index].id}\">${detail.rows[index].id}</div>\n          </div>\n        </th>\n        ${row.map((column, columnIndex) => {\n          // console.log(column)\n          if (column) {\n            return `\n              <td><div class=\"inner\"><ul>${column.attributes.map(attribute => {\n              if (!attribute.attribute) console.error(attribute);\n              return `\n              <li>\n                <div\n                  class=\"togo-key-view\"\n                  data-subject-id=\"${this.#header[columnIndex].subjectId}\"\n                  data-key=\"${column.propertyKey}\"\n                  data-category-id=\"${attribute.id}\">${attribute.id}</div>\n                <a\n                  href=\"${attribute.attribute ? attribute.attribute.uri : ''}\"\n                  title=\"${attribute.attribute ? attribute.attribute.uri : ''}\"\n                  target=\"_blank\">${attribute.attribute ? attribute.attribute.label : attribute}</a>\n              </li>`;\n            }).join('')}</ul></div></td>`;\n          } else {\n            return '<td><div class=\"inner -empty\"></div></td>';\n          }\n        }).join('')}\n      </tr>`;\n    }).join(''));\n\n    // turn off auto-loading after last line is displayed\n    if (detail.done) {\n      this.#ROOT.classList.add('-complete');\n      this.#LOADING_VIEW.classList.remove('-shown');\n    } else {\n      this.#ROOT.classList.remove('-complete');\n      this.#LOADING_VIEW.classList.add('-shown');\n      this.#intersctionObserver.observe(this.#TABLE_END);\n    }\n\n    // attach event\n    rows.forEach((row, index) => {\n      const actualIndex = detail.tableData.offset + index;\n      const tr = this.#TBODY.querySelector(`:scope > tr[data-index=\"${actualIndex}\"]`);\n      tr.addEventListener('click', () => {\n        if (tr.classList.contains('-selected')) {\n          // hide stanza\n          tr.classList.remove('-selected');\n          DefaultEventEmitter.dispatchEvent(new CustomEvent(event.hideStanza));\n        } else {\n          // show stanza\n          this.#TBODY.querySelectorAll(':scope > tr').forEach(tr => tr.classList.remove('-selected'));\n          tr.classList.add('-selected');\n          // dispatch event\n          const customEvent = new CustomEvent(event.showStanza, {detail: {\n            subject: {\n              togoKey: this.#tableData.togoKey,\n              id: this.#tableData.subjectId,\n              value: tr.dataset.togoId\n            },\n            properties: row\n          }});\n          DefaultEventEmitter.dispatchEvent(customEvent);\n        }\n      })\n    });\n  }\n\n  #failed(tableData) {\n    console.log(tableData)\n    this.#ROOT.classList.add('-complete');\n    this.#LOADING_VIEW.classList.remove('-shown');\n  }\n\n}\n","import DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport * as event from '../events';\n\nexport default class BalloonView {\n\n  #ROOT;\n  #CONTAINER;\n\n  constructor() {\n\n    // make element\n    this.#ROOT = document.createElement('div');\n    this.#ROOT.className = 'balloon-view';\n    document.querySelector('body').insertAdjacentElement('beforeend', this.#ROOT);\n    this.#ROOT.innerHTML = '<div class=\"container\"></div>';\n    this.#CONTAINER = this.#ROOT.querySelector(':scope > .container');\n\n    // event listener\n    DefaultEventEmitter.addEventListener(event.enterPropertyValueItemView, e => {\n      this.#CONTAINER.innerHTML = `\n        <header>${e.detail.label}</header>\n        ${e.detail.values.map(value => `<dl>\n          <dt>${value.key}:</dt>\n          <dd>${value.value}</dd>\n        </dl>`).join('')}`;\n      // geography\n      const rect = e.detail.elm.getBoundingClientRect();\n      const isBelow = window.innerHeight * .3 > rect.top;\n      this.#ROOT.style.left = (rect.left + rect.width * .5) + 'px';\n      if (isBelow) {\n        this.#ROOT.classList.add('-below');\n        this.#ROOT.style.top = (rect.top + 10) + 'px';\n      } else {\n        this.#ROOT.classList.remove('-below');\n        this.#ROOT.style.top = rect.top + 'px';\n      }\n      this.#ROOT.classList.add('-showing');\n    });\n    DefaultEventEmitter.addEventListener(event.leavePropertyValueItemView, e => {\n      this.#ROOT.classList.remove('-showing');\n    });\n  }\n\n}","import App from \"./App\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport ConditionBuilder from \"./ConditionBuilder\";\nimport * as event from '../events';\nimport Records from \"./Records\";\n\nconst LIMIT = 100;\n\nexport default class TableData {\n\n  #condition;\n  #serializedHeader;\n  #queryIds;\n  #rows;\n  #abortController;\n  #isAutoLoad;\n  #isLoaded;\n  #startTime;\n  #ROOT;\n  #STATUS;\n  #INDICATOR_TEXT_AMOUNT;\n  #INDICATOR_TEXT_TIME;\n  #INDICATOR_BAR;\n  #BUTTON_PREPARE_DOWNLOAD;\n  #BUTTON_START_DOWNLOAD;\n\n  constructor(condition, elm) {\n    console.log(condition)\n    console.log(ConditionBuilder)\n\n    this.#isAutoLoad = false;\n    this.#isLoaded = false;\n    this.#condition = condition;\n    this.#serializedHeader = [\n      ...condition.attributes.map(property => property.query.propertyId),\n      ...condition.properties.map(property => property.query.propertyId)\n    ];\n    this.#queryIds = [];\n    this.#rows = [];\n\n    // view\n    elm.classList.add('table-data-controller-view');\n    elm.dataset.status = 'load ids';\n\n    elm.innerHTML = `\n    <div class=\"conditions\">\n      <div class=\"condiiton\">\n        <p title=\"${condition.togoKey}\">${condition.togoKey}</p>\n      </div>\n      ${condition.attributes.map(property => `<div class=\"condiiton -value\" style=\"background-color: hsl(${property.subject.hue}, 45%, 50%)\">\n        <p title=\"${property.property.label}\">${property.property.label}</p>\n      </div>`).join('')}\n      ${condition.properties.map(property => `<div class=\"condiiton -value\" style=\"color: hsl(${property.subject.hue}, 45%, 50%)\">\n        <p title=\"${property.property.label}\">${property.property.label}</p>\n      </div>`).join('')}\n      \n    </div>\n    <div class=\"button close-button-view\" title=\"Delete\" data-button=\"delete\"></div>\n    <div class=\"status\">\n      <p>Getting id list</p>\n    </div>\n    <div class=\"indicator\">\n      <div class=\"text\">\n        <div class=\"amount-of-data\"></div>\n        <div class=\"remaining-time\"></div>\n      </div>\n      <div class=\"progress\">\n        <div class=\"bar\"></div>\n      </div>\n    </div>\n    <div class=\"controller\">\n      <div class=\"button autorenew\" title=\"Prepare for download\" data-button=\"prepare-download\">\n        <span class=\"material-icons-outlined autorenew\">autorenew</span><span class=\"prepare-data\">prepare data</span>\n      </div>\n      <div class=\"button downloads\" title=\"Download JSON \" data-button=\"start-download\">\n        <a class=\"json\" href=\"\" download=\"sample.json\">\n          <span class=\"material-icons-outlined\">download</span>\n          <span class=\"text\">JSON</span>\n        </a>\n      </div>\n      <div class=\"button\" title=\"Restore as condition\" data-button=\"restore\">\n        <span class=\"material-icons-outlined\">settings_backup_restore</span><span>edit</span>\n      </div>\n    </div>\n    `;\n\n    // reference　\n    this.#ROOT = elm;\n    this.#STATUS = elm.querySelector(':scope > .status > p');\n    const INDICATOR = elm.querySelector(':scope > .indicator');\n    this.#INDICATOR_TEXT_AMOUNT = INDICATOR.querySelector(':scope > .text > .amount-of-data');\n    this.#INDICATOR_TEXT_TIME = INDICATOR.querySelector(':scope > .text > .remaining-time');\n    this.#INDICATOR_BAR = INDICATOR.querySelector(':scope > .progress > .bar');\n    const BUTTONS = [...elm.querySelectorAll(':scope > .controller > .button')];\n    this.#BUTTON_PREPARE_DOWNLOAD = BUTTONS.find(button => button.dataset.button === 'prepare-download');\n    this.#BUTTON_START_DOWNLOAD = BUTTONS.find(button => button.dataset.button === 'start-download');\n\n    // events\n    elm.addEventListener('click', () => {\n      if (elm.classList.contains('-current')) return;\n      this.select();\n    });\n    this.#BUTTON_PREPARE_DOWNLOAD.addEventListener('click', e => {\n      e.stopPropagation();\n      if (this.#isAutoLoad == false && this.#ROOT.dataset.status != 'complete') {\n        this.#isAutoLoad == true;\n        this.#autoLoad();\n        this.#BUTTON_PREPARE_DOWNLOAD.querySelector(':scope > .autorenew').classList.add('lotation');\n        this.#BUTTON_PREPARE_DOWNLOAD.querySelector(':scope > .prepare-data').innerHTML='stop';\n      } else {\n        this.#isAutoLoad = false;\n        this.#BUTTON_PREPARE_DOWNLOAD.querySelector(':scope > .autorenew').classList.remove('lotation');\n        this.#BUTTON_PREPARE_DOWNLOAD.querySelector(':scope > .prepare-data').innerHTML='prepare data';\n      }\n    });\n    // delete button\n    // BUTTONS.find(button => button.dataset.button === 'delete').addEventListener('click', e => {\n    //   e.stopPropagation();\n    //   console.log('delete')\n    //   const element = document.querySelector('.table-data-controller-view');\n    //   element.parentNode.removeChild(element)\n    // });\n    BUTTONS.find(button => button.dataset.button === 'restore').addEventListener('click', e => {\n      e.stopPropagation();\n      console.log('restore');\n      console.log(this.#condition.attributes);\n      this.#condition.attributes.forEach (attribute => {\n        ConditionBuilder.setPropertyValues({\n          subject: attribute.subject,\n          property: attribute.property,\n          values: attribute.query.categoryIds.map(categoryId => {\n            console.log(Records.getValue(attribute.query.propertyId, categoryId));\n            return {\n              categoryId: categoryId,\n              label: Records.getValue(attribute.query.propertyId, categoryId).label,\n              ancestors: []\n            }\n          })\n        });\n      })\n      this.#condition.properties.forEach (property => {\n        ConditionBuilder.setPropertyValues({\n          subject: property.subject,\n          property: property.property,\n          values: [{\n            \n          }]\n        });\n      })\n    })\n    this.select();\n    this.#getQueryIds();\n  }\n  \n\n  /* private methods */\n\n\n  #getQueryIds() {\n    // reset\n    this.#abortController = new AbortController();\n    this.#ROOT.classList.add('-fetching');\n    fetch(\n      `${App.aggregatePrimaryKeys}?togoKey=${this.#condition.togoKey}&properties=${encodeURIComponent(JSON.stringify(this.#condition.attributes.map(property => property.query)))}`,\n      {\n        signal: this.#abortController.signal\n      })\n      .catch(error => {\n        throw Error(error);\n      })\n      .then(responce => {\n        console.log(responce);\n        if (responce.ok) {\n          return responce\n        };\n        this.#STATUS.classList.add('-error');\n        this.#STATUS.textContent = `${responce.status} (${responce.statusText})`;\n        throw Error(responce);\n      })\n      .then(responce => {\n        // const reader = responce.body.getReader();\n        // console.log(reader);\n        return responce.json();\n      })\n      .then(queryIds => {\n        console.log(queryIds)\n        this.#queryIds = queryIds;\n        // display\n        this.#ROOT.dataset.status = 'load rows';\n        this.#STATUS.textContent = '';\n        this.#INDICATOR_TEXT_AMOUNT.innerHTML = `${this.offset.toLocaleString()} / ${this.#queryIds.length.toLocaleString()}`;\n        this.#startTime = Date.now();\n        this.#getProperties();\n      })\n      .catch(error => {\n        // TODO:\n        console.error(error)\n        const customEvent = new CustomEvent(event.failedFetchTableDataIds, {detail: this});\n        DefaultEventEmitter.dispatchEvent(customEvent);\n      })\n      .finally(() => {\n        this.#ROOT.classList.remove('-fetching');\n      });\n  }\n\n  #getProperties() {\n    this.#ROOT.classList.add('-fetching');\n    this.#STATUS.textContent = 'Getting data';\n    fetch(\n      `${App.aggregateRows}?togoKey=${this.#condition.togoKey}&properties=${encodeURIComponent(JSON.stringify(this.#condition.attributes.map(property => property.query).concat(this.#condition.properties.map(property => property.query))))}&queryIds=${encodeURIComponent(JSON.stringify(this.#queryIds.slice(this.offset, this.offset + LIMIT)))}`,\n      {\n        signal: this.#abortController.signal\n      })\n      .then(responce => responce.json())\n      .then(rows => {\n        console.log(rows)\n        this.#rows.push(...rows);\n        this.#isLoaded = this.offset >= this.#queryIds.length;\n        // display\n        this.#ROOT.classList.remove('-fetching');\n        this.#STATUS.textContent = 'Awaiting';\n        this.#INDICATOR_TEXT_AMOUNT.innerHTML = `${this.offset.toLocaleString()} / ${this.#queryIds.length.toLocaleString()}`;\n        this.#INDICATOR_BAR.style.width = `${(this.offset / this.#queryIds.length) * 100}%`;\n        this.#updateRemainingTime();\n        // dispatch event\n        const customEvent = new CustomEvent(event.addNextRows, {detail: {\n          tableData: this,\n          rows,\n          done: this.#isLoaded\n        }});\n        DefaultEventEmitter.dispatchEvent(customEvent);\n        // turn off after finished\n        if (this.#isLoaded) {\n          this.#complete();\n        } else if (this.#isAutoLoad) {\n          this.#getProperties();\n        }\n      })\n      .catch(error => {\n        this.#ROOT.classList.remove('-fetching');\n        console.error(error) // TODO:\n      });\n  };\n  \n  #updateRemainingTime() {\n    let singleTime = (Date.now() - this.#startTime) / this.offset; \n    let remainingTime;\n    if (this.offset == 0) {\n      remainingTime = '';\n    } else if (this.offset >= this.#queryIds.length) {\n      remainingTime = 0;\n    } else {\n      remainingTime = singleTime * this.#queryIds.length * (this.#queryIds.length - this.offset) / this.#queryIds.length / 1000;\n    }\n    if (remainingTime >= 3600) {\n      this.#INDICATOR_TEXT_TIME.innerHTML = `${Math.round(remainingTime / 3600)} hr.`;\n    } else if (remainingTime >= 60) {\n      this.#INDICATOR_TEXT_TIME.innerHTML = `${Math.round(remainingTime / 60)} min.`;\n    } else if (remainingTime >= 0) {\n      this.#INDICATOR_TEXT_TIME.innerHTML = `${Math.floor(remainingTime)} sec.`;\n    } else {\n      this.#INDICATOR_TEXT_TIME.innerHTML = ``;\n    }\n  };\n  \n  #autoLoad() {\n    if (this.#isLoaded) return;\n    this.#isAutoLoad = true;\n    this.#ROOT.classList.add('-autoload');\n    this.#getProperties();\n  }\n\n  #complete() {\n    this.#ROOT.dataset.status = 'complete';\n    this.#STATUS.textContent = 'Complete';\n    this.#BUTTON_PREPARE_DOWNLOAD.querySelector(':scope > .autorenew').classList.add('lotation');\n    const jsonBlob = new Blob([JSON.stringify(this.#rows, null, 2)], {type : 'application/json'});\n    const jsonUrl = URL.createObjectURL(jsonBlob);\n    this.#BUTTON_START_DOWNLOAD.querySelector(':scope > .json').setAttribute('href', jsonUrl);\n  }\n\n  /* public methods */\n\n  select() {\n    this.#ROOT.classList.add('-current');\n    // dispatch event\n    const customEvent1 = new CustomEvent(event.selectTableData, {detail: this});\n    DefaultEventEmitter.dispatchEvent(customEvent1);\n    // send rows\n    if (this.#ROOT.dataset.status !== 'load ids') {\n      const done = this.offset >= this.#queryIds.length;\n      const customEvent2 = new CustomEvent(event.addNextRows, {detail: {\n        tableData: this, \n        rows: this.#rows,\n        done\n      }});\n      DefaultEventEmitter.dispatchEvent(customEvent2);\n    }\n  }\n\n  deselect() {\n    this.#ROOT.classList.remove('-current');\n  }\n\n  next() {\n    if (this.#isAutoLoad) return;\n    this.#getProperties();\n  }\n\n  /* public accessors */\n\n  get offset() {\n    return this.#rows.length;\n  }\n  get togoKey() {\n    return this.condition.togoKey;\n  }\n  get subjectId() {\n    return this.condition.subjectId;\n  }\n  get condition() {\n    return this.#condition;\n  }\n  get serializedHeader() {\n    return this.#serializedHeader;\n  }\n  get data() {\n    return this.#rows;\n  }\n  get rateOfProgress() {\n    return this.#rows.length / this.#queryIds.length;\n  }\n}","import TableData from \"./TableData\";\nimport DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport * as event from '../events';\n\nexport default class ConditionsController {\n\n  #tableData;\n  #body;\n  #conditionsContainer;\n\n  constructor(elm) {\n\n    this.#tableData = [];\n\n    // references\n    this.#conditionsContainer = elm.querySelector(':scope > .conditions');\n    this.#body = document.querySelector('body');\n\n    // event listener\n    DefaultEventEmitter.addEventListener(event.completeQueryParameter, e => this.#setTableData(e.detail));\n    DefaultEventEmitter.addEventListener(event.selectTableData, e => this.#selectTableData(e.detail));\n  }\n\n  /* private methods */\n\n  #setTableData(newCondition) {\n\n    // find matching condition from already existing conditions\n    // TODO: うまく検出できていない\n    const sameConditionTableData = this.#tableData.find(tableData => {\n      const matchTogoKey = newCondition.togoKey === tableData.condition.togoKey;\n      // compare properties\n      const matchProperties = newCondition.properties.every(newProperty => {\n        return tableData.condition.properties.find(property => newProperty.query.propertyId === property.query.propertyId)\n      });\n      // compare attributes\n      const matchAttributes = newCondition.attributes.every(newProperty => {\n        return tableData.condition.attributes.find(property => {\n          const matchId = newProperty.query.propertyId === property.query.propertyId;\n          let matchValues = newProperty.query.categoryIds.every(categoryId => property.query.categoryIds.indexOf(categoryId) !== -1);\n          return matchId && matchValues;\n        });\n      });\n      return matchTogoKey && matchProperties && matchAttributes;\n    });\n\n    if (sameConditionTableData) {\n      // use existing table data\n      sameConditionTableData.select();\n    } else {\n      // make new table data\n      const elm = document.createElement('div');\n      this.#conditionsContainer.insertAdjacentElement('afterbegin', elm);\n      this.#tableData.push(new TableData(newCondition, elm));\n    }\n  }\n\n  #selectTableData(selectedTableData) {\n    this.#body.dataset.display = 'results';\n    // deselect\n    for (const tableData of this.#tableData) {\n      if (tableData !== selectedTableData) tableData.deselect();\n    }\n  }\n\n}\n","import DefaultEventEmitter from './DefaultEventEmitter';\nimport Records from './Records';\nimport * as event from '../events';\n\nconst PATH = 'https://integbio.jp/togosite/sparqlist/api/';\nconst DATA_FROM_USER_IDS = 'data_from_user_ids';\n\nexport default class UploadUserIDsView {\n\n  #BODY;\n  #ROOT;\n  #USER_KEY;\n  #USER_IDS;\n\n  constructor(elm) {\n\n    this.#BODY = document.querySelector('body');\n    this.#ROOT = elm;\n    const form = elm.querySelector(':scope > form');\n    this.#USER_KEY = form.querySelector(':scope > label > select');\n    this.#USER_IDS = form.querySelector(':scope > label > input');\n\n    // atache events\n    form.querySelector(':scope > .buttons > button:nth-child(1)').addEventListener('click', e => {\n      e.stopPropagation();\n      this.#fetch();\n      return false;\n    });\n    form.querySelector(':scope > .buttons > button:nth-child(2)').addEventListener('click', e => {\n      e.stopPropagation();\n      this.#clear();\n      return false;\n    });\n\n    // event listeners\n    DefaultEventEmitter.addEventListener(event.defineTogoKey, e => {\n      this.#defineTogoKeys(e.detail);\n    });\n\n  }\n\n  // private methods\n\n  #defineTogoKeys(togoKeys) {\n    console.log(togoKeys)\n    this.#USER_KEY.innerHTML = togoKeys.map(togoKey => `<option value=\"${togoKey.togoKey}\" data-subject-id=\"${togoKeys.subjectId}\">${togoKey.label} (${togoKey.togoKey})</option>`).join('');\n  }\n\n  #fetch() {\n\n    console.log(this.#USER_KEY.value)\n    const queryTemplate = `${PATH + DATA_FROM_USER_IDS}?sparqlet=@@sparqlet@@&primaryKey=@@primaryKey@@&categoryIds=&userKey=${this.#USER_KEY.value}&userIds=${encodeURIComponent(this.#USER_IDS.value)}`;\n\n    Records.properties.forEach(property => {\n      console.log(property)\n      const propertyId = property.propertyId;\n      fetch(queryTemplate\n        .replace('@@sparqlet@@', encodeURIComponent(property.data))\n        .replace('@@primaryKey@@', encodeURIComponent(property.primaryKey)))\n      .then(responce => responce.json())\n      .then(values => {\n        console.log(values)\n        this.#BODY.classList.add('-showuserids');\n        // dispatch event\n        const customEvent = new CustomEvent(event.setUserValues, {detail: {\n          propertyId,\n          values\n        }});\n        DefaultEventEmitter.dispatchEvent(customEvent);\n      });\n    });\n\n  }\n\n  #clear() {\n    this.#BODY.classList.remove('-showuserids');\n    const customEvent = new CustomEvent(event.clearUserValues);\n    DefaultEventEmitter.dispatchEvent(customEvent);\n  }\n\n}\n","export const PROPERTIES = 'https://raw.githubusercontent.com/dbcls/togosite/develop/config/togosite-human/properties.json';\nexport const TEMPLATES = 'https://raw.githubusercontent.com/dbcls/togosite/develop/config/togosite-human/templates.json';\nexport const AGGREGATE = 'https://raw.githubusercontent.com/dbcls/togosite/develop/config/togosite-human/aggregate.json';\n","import DefaultEventEmitter from \"./DefaultEventEmitter\";\nimport ConditionBuilderView from './ConditionBuilderView.js';\nimport Records from './Records.js';\nimport ReportsView from './ReportsView.js';\nimport ConceptView from './ConceptView.js';\nimport ResultsTable from './ResultsTable.js';\nimport BalloonView from './BalloonView.js';\nimport ConditionsController from \"./ConditionsController\";\nimport UploadUserIDsView from \"./UploadUserIDsView\";\nimport * as event from '../events'\nimport * as api from '../api'\n\nclass App {\n\n  #viewModes;\n  #aggregate;\n\n  constructor() {\n  }\n\n  ready() {\n\n    const body = document.querySelector('body');\n\n    // view modes\n    this.#viewModes = {};\n    document.querySelectorAll('#Properties > .header > nav .viewmodecontroller input[type=\"checkbox\"]').forEach(checkbox => {\n      this.#viewModes[checkbox.value] = checkbox.checked;\n      checkbox.addEventListener('click', () => {\n        if (checkbox.value === 'heatmap')  body.dataset.heatmap = checkbox.checked;\n        this.#viewModes[checkbox.value] = checkbox.checked;\n        const customEvent = new CustomEvent(event.changeViewModes, {detail: this.#viewModes});\n        DefaultEventEmitter.dispatchEvent(customEvent);\n      });\n    });\n\n    // set up views\n    new ConditionBuilderView(document.querySelector('#ConditionBuilder'));\n    new ConditionsController(document.querySelector('#Conditions'));\n    const reportsView = new ReportsView(document.querySelector('#Reports'));\n    new ResultsTable(document.querySelector('#ResultsTable'));\n    new BalloonView();\n    new UploadUserIDsView(document.querySelector('#UploadUserIDsView'));\n\n    // load config json\n    let stanzaTtemplates;\n    Promise.all([\n      fetch(api.PROPERTIES),\n      fetch(api.TEMPLATES),\n      fetch(api.AGGREGATE)\n    ])\n      .then(responces => Promise.all(responces.map(responce => responce.json())))\n      .then(([subjects, templates, aggregate]) => {\n        stanzaTtemplates = templates;\n        Records.setSubjects(subjects);\n\n        // define primary keys\n        const togoKeys = subjects.map(subject => {\n          return {\n            label: subject.subject,\n            togoKey: subject.togoKey,\n            subjectId: subject.subjectId\n          }\n        });\n        const customEvent = new CustomEvent(event.defineTogoKey, {detail: togoKeys});\n        DefaultEventEmitter.dispatchEvent(customEvent);\n\n        // set stanza scripts\n        document.querySelector('head').insertAdjacentHTML('beforeend', templates.stanzas.map(stanza => `<script type=\"module\" src=\"${stanza}\" async></script>`).join(''));\n        // aggregate\n        this.#aggregate = Object.freeze(aggregate);\n\n        // get stanza templates\n        return Promise.all(\n          Object.keys(templates.templates).map(key => fetch(templates.templates[key]))\n        );\n      })\n      .then(responces => Promise.all(responces.map(responce => responce.text())))\n      .then(templates => {\n        // set stanza templates\n        const stanzaTemplates = Object.fromEntries(Object.keys(stanzaTtemplates.templates).map((stanza, index) => [stanza, templates[index]]));\n        reportsView.defineTemplates(stanzaTemplates);\n        // define properties (app start)\n        this.#makeConceptViews();\n        // Records.setSubjects(this.#subjects);\n      });\n  }\n\n  // private methods\n\n  #makeConceptViews() {\n    const conceptsContainer = document.querySelector('#Properties > .concepts');\n    Records.subjects.forEach(subject => {\n      const elm = document.createElement('section');\n      new ConceptView(subject, elm);\n      conceptsContainer.insertAdjacentElement('beforeend', elm);\n    });\n  }\n\n  // public methods\n\n  // utilities\n  getHslColor(hue) {\n    return `hsl(${hue}, 50%, 55%)`;\n  }\n\n  // accessor\n  get viewModes() {\n    return this.#viewModes;\n  }\n  get aggregatePrimaryKeys() {\n    return this.#aggregate.filter.url;\n  }\n  get aggregateRows() {\n    return this.#aggregate.table.url;\n  }\n\n}\n\nexport default new App();\n","import App from './classes/App.js';\n\nglobalThis.togositeapp = App;\nApp.ready();\n"],"names":["DefaultEventEmitter","EventTarget","Records","subjects","i","length","hue","Object","freeze","forEach","subject","properties","property","push","assign","subjectId","console","log","propertyId","values","find","categoryId","getProperty","value","defineTogoKey","setUserValues","clearUserValues","changeViewModes","mutatePropertyCondition","mutatePropertyValueCondition","mutateEstablishConditions","completeQueryParameter","hideStanza","showStanza","failedFetchTableDataIds","addNextRows","selectTableData","enterPropertyValueItemView","leavePropertyValueItemView","ConditionBuilder","condition","customEvent","CustomEvent","event","detail","action","dispatchEvent","index","findIndex","splice","originalValues","startIndex","originalValue","originalIndex","attrCondition","addPropertyValue","removePropertyValue","map","query","attributesForEachProperties","attributes","keys","categoryIds","togoKey","established","ConditionBuilderView","elm","body","document","querySelector","conditionsContainer","addEventListener","dataset","display","makeQueryParameter","e","disabled","togoKeys","innerHTML","label","join","target","setSubject","Event","view","createElement","classList","add","App","getHslColor","insertAdjacentElement","remove","removeProperty","parentNode","removeChild","childNodes","style","backgroundColor","ancestors","ancestor","ReportsView","_stanzas","returnButton","templates","id","undefined","some","subjectProperty","replace","collapseView","button","collapse","content","toggle","ColumnSelectorView","items","sparqlist","_subject","_property","_sparqlist","_itemStatus","_columns","_view","_container","_loadingView","ul","querySelectorAll","li","isChecked","checked","_addItems","_makeColumn","depth","parent","item","hasChild","selected","children","_items","count","toLocaleString","_update","viewModes","log10","selectedItemKeys","filter","key","selectedItem","_getChildren","checkbox","stopPropagation","unshift","isLog10","max","Math","Array","from","fetch","then","responce","json","gap","scrollWidth","clientWidth","scrollLeft","NUM_OF_GRID","HistogramRangeSelectorView","overview","repeat","histogram","selector","width","graph","selectorController","isMouseDown","startX","unit","getBoundingClientRect","layerX","selectedWidth","floor","bar","selectedItems","setPropertyValues","processedMax","digits","String","ceil","Number","charAt","padEnd","grid","scale","bottom","textContent","indexOf","height","item_","MIN_PIN_SIZE","MAX_PIN_SIZE","RANGE_PIN_SIZE","TrackOverviewCategorical","sum","reduce","acc","countLog10","color","pin","userValueCount","contains","isArea","area","fixedWidth","left","userValue","ratio","size","top","TrackView","container","positionRate","data","description","valuesContainer","addProperty","catch","error","insertAdjacentHTML","setValues","viewMethod","ConceptView","propertiesContainer","StatisticsView","tableData","datum","flat","attribute","Set","counts","countMax","position","rates","getValue","rateOfProgress","rateMax","rate","labels","ResultsTable","TABLE","IntersectionObserver","entries","entry","isIntersecting","mutationObserver","MutationObserver","mutations","mutation","type","attributeName","unobserve","deselect","observe","next","concat","primaryKey","rows","row","serializedHeader","head","offset","encodeURIComponent","JSON","stringify","column","columnIndex","propertyKey","uri","done","actualIndex","tr","togoId","BalloonView","className","rect","isBelow","window","innerHeight","LIMIT","TableData","status","INDICATOR","BUTTONS","select","customEvent1","customEvent2","AbortController","aggregatePrimaryKeys","signal","Error","ok","statusText","queryIds","Date","now","finally","aggregateRows","slice","singleTime","remainingTime","round","jsonBlob","Blob","jsonUrl","URL","createObjectURL","setAttribute","ConditionsController","newCondition","sameConditionTableData","matchTogoKey","matchProperties","every","newProperty","matchAttributes","matchId","matchValues","selectedTableData","PATH","DATA_FROM_USER_IDS","UploadUserIDsView","form","queryTemplate","PROPERTIES","TEMPLATES","AGGREGATE","heatmap","reportsView","stanzaTtemplates","Promise","all","api","responces","aggregate","setSubjects","stanzas","stanza","text","stanzaTemplates","fromEntries","defineTemplates","url","table","conceptsContainer","globalThis","togositeapp","ready"],"mappings":"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"}